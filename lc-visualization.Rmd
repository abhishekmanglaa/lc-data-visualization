---
title: "Lending Club Data"
output: html_document
---
\vspace{0.25in}


```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)

#make sure to set your working directory!
lc = read_csv('Data/LendingClub_LoanStats_2011_v2.csv')
```

Scatter plots

a) A scatter plot relating the loan amount (the amount that each borrower requested) to the funded amount (the amount funded by investors)\
To make an attractive chart, you will have to (at least) change the labels on the axis, the alpha values, and the background, gridlines, etc.

```{r}
ggplot(lc, aes(x = loan_amnt, y = funded_amnt_inv)) + 
  geom_point(alpha = 0.3, na.rm = TRUE, color = "#00AFBB") +
  xlab("Requested Loan Amount") + 
  ylab("Amount Funded by Investors") +
  ggtitle("Requested vs Funded") +
  theme(panel.background = element_blank() , axis.line = element_line(colour = 'black'))
```
b) A plot exploring the relationship between annual income (the borrower's income) and loan amount (the amount that the borrower requests). Use the logarithmic scale.

```{r}
lc %>%
  select(annual_inc, loan_amnt) %>%
  drop_na() %>%
  ggplot(aes(x = log(annual_inc), y = log(loan_amnt))) +
  geom_point(alpha = .02, color = 'lightblue') + 
  stat_smooth(method="lm", se=FALSE) +
  xlab("Log of Annual Income") + 
  ylab(" Log of Loan Amount") + 
  ggtitle("Log Plot of Annual Income Vs Loan Amount") +
  theme(panel.background = element_blank() , axis.line = element_line(colour = 'black'))
```

c) Bubble Chart and Colors

```{r}
lc %>% 
  select(loan_amnt, int_rate, grade, dti) %>%
  drop_na() %>%
  mutate(int_rate_numeric = as.numeric(gsub("\\%", "", int_rate))) %>%
  ggplot( aes(x = dti, y = as.numeric(int_rate_numeric), size = loan_amnt, color = grade)) + 
  geom_point(alpha=0.1) +
  xlab("Debt-to-Income") + 
  ylab("Interest Rate") + 
  ggtitle("Interest Rate vs DTI") +
  theme(panel.background = element_blank() , axis.line = element_line(colour = 'black')) +
  scale_x_continuous(breaks=c(0,10,20,30), labels = c('0','10','20','30'), limits = c(0,30)) +
  scale_y_continuous(breaks=c(5,10,15,20,25), labels = c('5','10','15','20','25'), limits = c(5,25)) +
  labs(size = "Loan Amount", color = "Grade")
```


